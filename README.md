# NBR Detection

This project is to determine COGs **Normalized Burn Ratio** values and further compare differences over time.

For more information, please refer to this [explanation](https://un-spider.org/advisory-support/recommended-practices/recommended-practice-burn-severity/in-detail/normalized-burn-ratio) on un-spider.

## Prerequisite

To run the script, libraries are required.

- GDAL
- rasterio
- numpy

These can be installed in a new virtual env or found in a pre-existing docker image [Development Seed](https://developmentseed.org/blog/2017-08-17-introducing-geolambda) offers.

## How to

The script can be ran from the command line or included in a project as an import.

### Command line

*Only calculate values for a single COG*

The python script can be ran from the command line. Two arguments are required, an input and output file path, name.

`python detect.py sample/cog output/output.tif`

#### Example

*From README directory*

`python nbrdetect/detect.py sample/HLS.S30.T11SKD.2022286T184329.v2.0 output/output.tif`

The GeoTiff(`output/output.tif`) was generated by the above command.

<img src="docs/output_screenshot.png" width="700">

### Importing

*Calculate values for a single COG and or compare two COGs*

Once the repo is built/installed with python's setup tools (`python install .`), you can access key functions to calculate NBR values of a geotiff or compare over time.

Functions include

```
evaluate_band_burn_ratio, 
evaluate_cog_burn_ratio, 
evaluate_cog_burn_ratio_difference
```

#### Example Usage #1
Calculate a COG's NBR values.

```
from nbrdetect import evaluate_cog_burn_ratio
    
if __name__ == "__main__":
    fn_cog = 'sample/HLS.S30.T11SKD.2022286T184329.v2.0'
    fn_out = 'output/output.tif'
    evaluate_cog_burn_ratio(fn_cog, fn_out)
```

#### Example Usage #2

Calculate the difference over time between two COGs of the same area.

```
from nbrdetect import evaluate_cog_burn_ratio_difference
    
if __name__ == "__main__":
    fn_cog_before = 'sample/HLS.S30.T10SFJ.2022239T184919.v2.0'
    fn_cog_after = 'sample/HLS.S30.T10SFJ.2022314T185621.v2.0'
    fn_out = 'output/difference.tif'
    evaluate_cog_burn_ratio_difference(fn_cog_before, fn_cog_after, fn_out)
```

Result

<img src="docs/burn_delta.png" width="700">

Further documentation is included on the functions.